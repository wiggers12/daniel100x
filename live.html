<!DOCTYPE html>
<html>
<head>
<title>Live VIP</title>
<style>
body { background:#000; color:#fff; font-family:Arial; text-align:center; }
video { width:100%; max-height:70vh; margin-top:20px; border-radius:12px; background:#111; }
</style>
</head>
<body>

<h2>ðŸ”´ LIVE VIP â€“ AO VIVO</h2>
<video id="livePlayer" autoplay playsinline></video>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { getFirestore, doc, onSnapshot, updateDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyBod8YVf5pKWI98m9rRR8axokDkNMlXX-k",
  authDomain: "aviatordaniel100x.firebaseapp.com",
  databaseURL: "https://aviatordaniel100x-default-rtdb.firebaseio.com",
  projectId: "aviatordaniel100x",
  storageBucket: "aviatordaniel100x.firebasestorage.app",
  messagingSenderId: "169015417803",
  appId: "1:169015417803:web:ce4aa4f9b77d5ddb07344e",
  measurementId: "G-EES9SVSV72"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

let pc;

onSnapshot(doc(db, "live", "stream"), async snap => {
    const data = snap.data();
    if (!data || !data.active) {
        document.getElementById("livePlayer").style.display = "none";
        return;
    }

    document.getElementById("livePlayer").style.display = "block";

    pc = new RTCPeerConnection();

    pc.ontrack = (event) => {
        document.getElementById("livePlayer").srcObject = event.streams[0];
    };

    await pc.setRemoteDescription(data.offer);

    const answer = await pc.createAnswer();
    await pc.setLocalDescription(answer);

    await updateDoc(doc(db, "live", "stream"), {
        answer: answer
    });
});
</script>

</body>
</html>
